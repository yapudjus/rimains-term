<!DOCTYPE html>
<html lang="fr">
 <head>
  <meta http-equiv="x-ua-compatible" content="IE=EDGE">
  <title>Parser les donn&eacute;es extraites [Les objets connect&eacute;s.]</title>
  <meta charset="UTF-8">
  <meta name="generator" content="SCENARI 4.2.106 / Opale 3.6.103">
  <meta name="revision" content="2019-03-19 08:10">
  <link rel="start" href="module_IoT_format_enseignant.html" title="Les objets connect&eacute;s.">
  <meta name="author" content="Nathalie CALAS-CADEVILLE ">
  <meta name="keywords" content>
  <meta name="date" content>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="../lib-md/w_scImgMgr/scImgMgr.css">
  <link rel="stylesheet" type="text/css" href="../lib-md/w_scCodeMgr/scCodeMgr.css">
  <script type="text/JavaScript">
/*0*/ var scServices = {id:"jtfhzgkc"};
/*1*/ window.scLoadParams = {destUri:"/co/7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API_5.html", pathToRoot:"../"};
</script>
  <script type="text/JavaScript" src="../lib-sc/scCoLib.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scSiLib.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scTiLib.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scPaLib.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scMapMgr.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scTooltipMgr.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scDynUiMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/s_assmnt.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scDragMgr.js"></script>
  <script type="text/JavaScript" src="../lib-sc/scAssmntMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_mathjax/mathjaxMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/s_scSearch/scSearch.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_tplMgr/tplMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_scCodeMgr/scCodeMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_searchMgr/searchMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_scMediaMgr/scMediaMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_scImgMgr/scImgMgr.js"></script>
  <script type="text/JavaScript" src="../lib-md/w_outMgr/outMgr.js"></script>
  <script type="text/JavaScript">
/*0*/ try{if(window.opener && window.opener.scServices && window.opener.scServices.id == scServices.id) scServices = window.opener.scServices; else if(window.parent && window.parent.scServices && window.parent.scServices.id == scServices.id) scServices = window.parent.scServices;}catch(e){}
scCodeMgr.registerCode("des:div.code");

scImgMgr.registerAdaptedImage("ide:content/des:img");

scImgMgr.registerGallery("des:div.galFra");

scImgMgr.registerZoom("des:a.imgZoom",{toolbar:1,mag:1,titlePath:"par:/nsi:/des:span.capTi"});

</script>
  <link type="text/css" rel="stylesheet" href="../skin/css/main.css" media="all">
  <link type="text/css" rel="stylesheet" href="../skin/css/skin.css" media="all">
  <link type="text/css" rel="stylesheet" href="../skin/css/print.css" media="print">
  <script type="text/JavaScript">
outMgr.declareOutline("module_IoT_format_enseignant.txt");
	</script> </head>
 <body class="default module expUc">
  <div id="root"><header id="header" role="banner"><h1><span>Les objets connect&eacute;s.</span></h1><nav role="navigation"><ul id="accessibility"><li class="waiContent"><a href="#content"><span>contenu</span></a></li><li class="waiMenu"><a href="#menu"><span>menu</span></a></li><li class="waiNav"><a href="#navigation"><span>navigation</span></a></li><li class="waiTools"><a href="#tools"><span>outils</span></a></li></ul></nav></header><main id="main" role="main"><div id="document"><div id="content" tabindex="-1"><div class="scroller"><hr class="hidden"><section class="hBk article expUc"><h2 class="hBk_ti"><span>Parser les donn&eacute;es extraites</span></h2><div class="hBk_co "><div class="def pBk"><h3 class="def_ti pBk_ti"><span><i class="type"><span>D&eacute;finition</span></i><span class="hidden"> : </span><span class="title">Parser&nbsp;?</span></span></h3><div class="def_co pBk_co"><div class="rBk "><p><strong class="txt_emp_is ">Parser = faire l'analyse syntaxique</strong></p></div></div></div><div class="complement pBk"><h3 class="complement_ti pBk_ti"><span><i class="type"><span>Compl&eacute;ment</span></i><span class="hidden"> : </span><span class="title">Analyse du json de infoclimat</span></span></h3><div class="complement_co pBk_co"><div class="rBk "><p>Que renvoie infoclimat&nbsp;? Quelles sont les cl&eacute;s et les valeurs renvoy&eacute;es dans le json&nbsp;?</p></div><div class="rBk res"><figure role="group" class="resInFlow png"><div class="resInFlow_co "><img src="../res/JSON_FIREFOX.png" width="346" height="369" alt></div></figure></div></div></div><div class="method pBk"><h3 class="method_ti pBk_ti"><span><i class="type"><span>M&eacute;thode</span></i><span class="hidden"> : </span><span class="title">Parser les donn&eacute;es...</span></span></h3><div class="method_co pBk_co"><div class="rBk "><p><strong class="txt_emp_is ">On souhaite extraire la date, l'heure, et la temp&eacute;rature :</strong></p></div><div class="rBk "><ol class="txt_ol "><li class="txt_oli "><p>Lire le Json complet puis extraire 15 relev&eacute;s de temp&eacute;ratures ainsi que la date et l'heure&nbsp;:</p></li></ol></div><div class="rBk "><p>Le programme complet &eacute;tant fourni, la description qui suit &eacute;claire quelques &eacute;tapes du tri de donn&eacute;es&nbsp;:</p></div><div class="rBk listing"><div><div class="code"><div class="code-form "><div class="CodeMirror-static cm-s-default" data-lang="text/x-csharp"><div class="CodeMirror-code"><div class="CodeMirror-line"><div class="CodeMirror-linenumber">1</div><pre><span class="cm-comment">// lecture des donnees JSON</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">2</div><pre>         <span class="cm-variable-3">String</span> <span class="cm-variable">ligne</span> <span class="cm-operator">=</span> <span class="cm-variable">http</span>.<span class="cm-variable">getString</span>();</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">3</div><pre></pre></div></div></div></div><pre class="code-raw noIndex " style="display:none;">// lecture des donnees JSON
         String ligne = http.getString();
</pre></div></div></div><div class="rBk "><p>2. Utilisation de la <strong class="txt_emp_is ">m&eacute;thode indexOf</strong> appliqu&eacute;e &agrave; ligne et d'un tableau pos pour stocker la position du <strong class="txt_emp_is ">mot cl&eacute;</strong> recherch&eacute;&nbsp;:</p><ul class="txt_il "><li class="txt_ili "><p><strong class="txt_emp_is ">&quot;sol&nbsp;:&quot;</strong> pour la temp&eacute;rature au niveau du sol</p></li><li class="txt_ili "><p><strong class="txt_emp_is ">&quot;2019-&quot;</strong> pour l'ann&eacute;e ce qui permettra de trouver la date et l'heure.</p></li></ul></div><div class="rBk listing"><div><div class="code"><div class="code-form "><div class="CodeMirror-static cm-s-default" data-lang="text/x-csharp"><div class="CodeMirror-code"><div class="CodeMirror-line"><div class="CodeMirror-linenumber">1</div><pre> <span class="cm-comment">// pos est l'index de position du mot cl&eacute; &quot;sol:&quot;</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">2</div><pre>        <span class="cm-comment">// indexOf donne l'index de position du premier caractere du mot cl&eacute; &quot;sol:&quot;,</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">3</div><pre>           <span class="cm-variable">pos</span>[<span class="cm-variable">i</span>] <span class="cm-operator">=</span> <span class="cm-variable">ligne</span>.<span class="cm-variable">indexOf</span>(<span class="cm-variable">keyword</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">4</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">5</div><pre>        <span class="cm-comment">// pos1 est l'index de position du mot cl&eacute; &quot;2019-&quot;</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">6</div><pre>           <span class="cm-variable">pos1</span>[<span class="cm-variable">i</span>]<span class="cm-operator">=</span><span class="cm-variable">ligne</span>.<span class="cm-variable">indexOf</span>(<span class="cm-variable">keyword2</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">7</div><pre>        </pre></div></div></div></div><pre class="code-raw noIndex " style="display:none;"> // pos est l'index de position du mot cl&eacute; &quot;sol:&quot;
        // indexOf donne l'index de position du premier caractere du mot cl&eacute; &quot;sol:&quot;,
           pos[i] = ligne.indexOf(keyword);

        // pos1 est l'index de position du mot cl&eacute; &quot;2019-&quot;
           pos1[i]=ligne.indexOf(keyword2);
        </pre></div></div></div><div class="rBk "><p>La m&eacute;thode indexOf renvoie -1 si elle ne trouve pas le mot cl&eacute; sinon elle renvoie la valeur de l'index de position du premier caract&egrave;re du mot cl&eacute;&nbsp;:</p><p>donc <strong class="txt_emp_is ">si pos[i] est positif  on a trouv&eacute; le mot cl&eacute;&nbsp;!</strong></p><p>Pour la date le json renvoie&nbsp;: &quot;2019-mm-jj hh:mm:ss&quot;</p><ul class="txt_il "><li class="txt_ili "><p>le mois est en position 6</p></li></ul><ul class="txt_il "><li class="txt_ili "><p>le jour est en position 9</p></li></ul><ul class="txt_il "><li class="txt_ili "><p>et l'heure en position 12</p></li></ul></div><div class="rBk "><p>3. Les <strong class="txt_emp_is ">variables d&eacute;clar&eacute;es</strong> sont&nbsp;:</p></div><div class="rBk listing"><div><div class="code"><div class="code-form "><div class="CodeMirror-static cm-s-default" data-lang="text/x-csharp"><div class="CodeMirror-code"><div class="CodeMirror-line"><div class="CodeMirror-linenumber">1</div><pre><span class="cm-variable-3">int</span> <span class="cm-variable">pos</span>[<span class="cm-number">15</span>] ;</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">2</div><pre><span class="cm-variable-3">int</span> <span class="cm-variable">pos1</span>[<span class="cm-number">15</span>] ;</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">3</div><pre><span class="cm-variable-3">float</span> <span class="cm-variable">temperature</span>[<span class="cm-number">15</span>];</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">4</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">5</div><pre><span class="cm-comment">// position des valeurs recherch&eacute;es mois jour heure dans la donn&eacute;e : &quot;2019-mm-jj hh:mm:ss&quot;</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">6</div><pre><span class="cm-variable-3">int</span> <span class="cm-variable">posmois</span><span class="cm-operator">=</span><span class="cm-number">6</span>;</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">7</div><pre><span class="cm-variable-3">int</span> <span class="cm-variable">posjour</span><span class="cm-operator">=</span><span class="cm-number">9</span>;</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">8</div><pre><span class="cm-variable-3">int</span> <span class="cm-variable">posheure</span><span class="cm-operator">=</span><span class="cm-number">12</span>;</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">9</div><pre><span class="cm-comment">// tableau de stokage des num&eacute;ros de mois</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">10</div><pre><span class="cm-variable-3">String</span> <span class="cm-variable">mois</span>[<span class="cm-number">15</span>];</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">11</div><pre><span class="cm-comment">//  tableau de stokage des dates</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">12</div><pre><span class="cm-variable-3">String</span> <span class="cm-variable">jour</span>[<span class="cm-number">15</span>];</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">13</div><pre><span class="cm-variable-3">String</span> <span class="cm-variable">nommois</span>[]<span class="cm-operator">=</span>{<span class="cm-string">&quot;Janvier&quot;</span>, <span class="cm-string">&quot;Fevrier&quot;</span>, <span class="cm-string">&quot;Mars&quot;</span>, <span class="cm-string">&quot;Avril&quot;</span>, <span class="cm-string">&quot;Mai&quot;</span>, <span class="cm-string">&quot;Juin&quot;</span>, <span class="cm-string">&quot;Juillet&quot;</span>, <span class="cm-string">&quot;Aout&quot;</span>, <span class="cm-string">&quot;Septembre&quot;</span>, <span class="cm-string">&quot;Octobre&quot;</span>, <span class="cm-string">&quot;Novembre&quot;</span>, <span class="cm-string">&quot;Decembre&quot;</span>};</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">14</div><pre><span class="cm-comment">//  tableau de stokage des heures</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">15</div><pre><span class="cm-variable-3">String</span> <span class="cm-variable">heure</span>[<span class="cm-number">15</span>];</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">16</div><pre></pre></div></div></div></div><pre class="code-raw noIndex " style="display:none;">int pos[15] ;
int pos1[15] ;
float temperature[15];

// position des valeurs recherch&eacute;es mois jour heure dans la donn&eacute;e : &quot;2019-mm-jj hh:mm:ss&quot;
int posmois=6;
int posjour=9;
int posheure=12;
// tableau de stokage des num&eacute;ros de mois
String mois[15];
//  tableau de stokage des dates
String jour[15];
String nommois[]={&quot;Janvier&quot;, &quot;Fevrier&quot;, &quot;Mars&quot;, &quot;Avril&quot;, &quot;Mai&quot;, &quot;Juin&quot;, &quot;Juillet&quot;, &quot;Aout&quot;, &quot;Septembre&quot;, &quot;Octobre&quot;, &quot;Novembre&quot;, &quot;Decembre&quot;};
//  tableau de stokage des heures
String heure[15];
</pre></div></div></div><div class="rBk "><p>4. <strong class="txt_emp_is ">Parsing des donn&eacute;es pour trouver l'heure, la date et le mois&nbsp;:</strong></p></div><div class="rBk listing"><div><div class="code"><div class="code-form "><div class="CodeMirror-static cm-s-default" data-lang="text/x-csharp"><div class="CodeMirror-code"><div class="CodeMirror-line"><div class="CodeMirror-linenumber">1</div><pre>   <span class="cm-keyword">if</span>(<span class="cm-variable">pos1</span>[<span class="cm-variable">i</span>]<span class="cm-operator">&gt;=</span><span class="cm-number">0</span>) </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">2</div><pre>            { <span class="cm-comment">/* 2019- trouve dans la ligne re&ccedil;ue*/</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">3</div><pre>                              </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">4</div><pre>            <span class="cm-comment">// longueur en nombre de caracteres du JSON</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">5</div><pre>                 <span class="cm-variable">longueur</span><span class="cm-operator">=</span><span class="cm-variable">ligne</span>.<span class="cm-variable">length</span>();</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">6</div><pre>              </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">7</div><pre>            <span class="cm-comment">// extraction de la date jusqu'&agrave; la fin de ligne</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">8</div><pre>                 <span class="cm-variable">lignedate</span><span class="cm-operator">=</span><span class="cm-variable">ligne</span>.<span class="cm-variable">substring</span>(<span class="cm-variable">pos1</span>[<span class="cm-variable">i</span>], <span class="cm-variable">pos1</span>[<span class="cm-variable">i</span>]<span class="cm-operator">+</span><span class="cm-number">20</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">9</div><pre>                 <span class="cm-variable">Serial</span>.<span class="cm-variable">print</span>(<span class="cm-string">&quot;lignedate = &quot;</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">10</div><pre>                 <span class="cm-variable">Serial</span>.<span class="cm-variable">println</span>(<span class="cm-variable">lignedate</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">11</div><pre>                                 </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">12</div><pre>            <span class="cm-comment">// compl&eacute;ter les tableaux mois, date et heure</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">13</div><pre>                 <span class="cm-variable">heure</span>[<span class="cm-variable">i</span>]<span class="cm-operator">=&amp;</span><span class="cm-variable">lignedate</span>[<span class="cm-variable">posheure</span>];</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">14</div><pre>            </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">15</div><pre>                 <span class="cm-variable">jour</span>[<span class="cm-variable">i</span>]<span class="cm-operator">=</span><span class="cm-variable">lignedate</span>.<span class="cm-variable">substring</span>(<span class="cm-variable">posjour</span>,<span class="cm-variable">posheure</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">16</div><pre>                 <span class="cm-variable">mois</span>[<span class="cm-variable">i</span>]<span class="cm-operator">=</span> <span class="cm-variable">lignedate</span>.<span class="cm-variable">substring</span>(<span class="cm-variable">posmois</span>,<span class="cm-variable">posjour</span><span class="cm-operator">-</span><span class="cm-number">1</span>);   </pre></div></div></div></div><pre class="code-raw noIndex " style="display:none;">   if(pos1[i]&gt;=0) 
            { /* 2019- trouve dans la ligne re&ccedil;ue*/
                              
            // longueur en nombre de caracteres du JSON
                 longueur=ligne.length();
              
            // extraction de la date jusqu'&agrave; la fin de ligne
                 lignedate=ligne.substring(pos1[i], pos1[i]+20);
                 Serial.print(&quot;lignedate = &quot;);
                 Serial.println(lignedate);
                                 
            // compl&eacute;ter les tableaux mois, date et heure
                 heure[i]=&amp;lignedate[posheure];
            
                 jour[i]=lignedate.substring(posjour,posheure);
                 mois[i]= lignedate.substring(posmois,posjour-1);   </pre></div></div></div><div class="rBk "><p><strong class="txt_emp_is ">Remarque&nbsp;: </strong></p><p>La m&eacute;thode <strong class="txt_emp_is ">substring(debut, fin)</strong> renvoie la cha&icirc;ne comprise entre l'index d&eacute;but et l'index fin</p><p>Pour le mois il faut retirer  1 &agrave; posjour pour enlever le symbole &quot;-&quot;</p></div><div class="rBk "><p>5. M&ecirc;me principe pour la<strong class="txt_emp_is "> temp&eacute;rature au niveau du sol</strong>&nbsp;:</p></div><div class="rBk listing"><div><div class="code"><div class="code-form "><div class="CodeMirror-static cm-s-default" data-lang="text/x-csharp"><div class="CodeMirror-code"><div class="CodeMirror-line"><div class="CodeMirror-linenumber">1</div><pre><span class="cm-keyword">if</span> (<span class="cm-variable">pos</span>[<span class="cm-variable">i</span>] <span class="cm-operator">&gt;=</span> <span class="cm-number">0</span>) { <span class="cm-comment">/* mot &quot;sol&quot; trouve dans les donn&eacute;es re&ccedil;ues */</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">2</div><pre>       <span class="cm-comment">// indexOf donne la position du d&eacute;but du mot cl&eacute;,</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">3</div><pre>       <span class="cm-comment">// en ajoutant sa longueur on se place &agrave; la fin.</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">4</div><pre>       <span class="cm-variable">pos</span>[<span class="cm-variable">i</span>] <span class="cm-operator">+=</span> <span class="cm-variable">keyword</span>.<span class="cm-variable">length</span>();</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">5</div><pre>       </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">6</div><pre>       <span class="cm-variable">Serial</span>.<span class="cm-variable">print</span>(<span class="cm-string">&quot;pos &quot;</span>);  <span class="cm-variable">Serial</span>.<span class="cm-variable">print</span>(<span class="cm-variable">i</span>);<span class="cm-variable">Serial</span>.<span class="cm-variable">print</span>(<span class="cm-string">&quot; = &quot;</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">7</div><pre>       <span class="cm-variable">Serial</span>.<span class="cm-variable">println</span>(<span class="cm-variable">pos</span>[<span class="cm-variable">i</span>]); </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">8</div><pre>               </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">9</div><pre>      <span class="cm-comment">// extraction de valeur &agrave; la fin de ligne</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">10</div><pre>             <span class="cm-variable">ligne</span><span class="cm-operator">=</span><span class="cm-variable">ligne</span>.<span class="cm-variable">substring</span>(<span class="cm-variable">pos</span>[<span class="cm-variable">i</span>], <span class="cm-variable">longueur</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">11</div><pre>             <span class="cm-variable">Serial</span>.<span class="cm-variable">print</span>(<span class="cm-string">&quot;extrait = &quot;</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">12</div><pre>             <span class="cm-variable">Serial</span>.<span class="cm-variable">println</span>(<span class="cm-variable">ligne</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">13</div><pre></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">14</div><pre>          <span class="cm-comment">// extraction de la valeur situ&eacute;e jusqu'&agrave; la premi&egrave;re virgule </span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">15</div><pre>             <span class="cm-variable-3">String</span> <span class="cm-variable">valeur_sol</span><span class="cm-operator">=</span><span class="cm-variable">ligne</span>.<span class="cm-variable">substring</span>(<span class="cm-number">0</span>,<span class="cm-variable">ligne</span>.<span class="cm-variable">indexOf</span>(<span class="cm-string">&quot;,&quot;</span>));</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">16</div><pre>          <span class="cm-comment">// affichage de la donn&eacute;e brute extraite</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">17</div><pre>             <span class="cm-variable">Serial</span>.<span class="cm-variable">print</span>(<span class="cm-string">&quot;temperature_sol = &quot;</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">18</div><pre>             <span class="cm-variable">Serial</span>.<span class="cm-variable">println</span>(<span class="cm-variable">valeur_sol</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">19</div><pre>     </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">20</div><pre>          </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">21</div><pre>          <span class="cm-comment">// conversion de la valeur du format texte au format flottant</span></pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">22</div><pre>             <span class="cm-variable">temperature</span>[<span class="cm-variable">i</span>] <span class="cm-operator">=</span> <span class="cm-variable">atof</span>(<span class="cm-operator">&amp;</span><span class="cm-variable">valeur_sol</span>[<span class="cm-number">0</span>])<span class="cm-operator">-</span><span class="cm-number">273</span>;</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">23</div><pre>             <span class="cm-variable">Serial</span>.<span class="cm-variable">print</span>(<span class="cm-string">&quot;temperature_sol = &quot;</span>);</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">24</div><pre>             <span class="cm-variable">Serial</span>.<span class="cm-variable">println</span>(<span class="cm-variable">temperature</span>[<span class="cm-variable">i</span>]);</pre></div></div></div></div><pre class="code-raw noIndex " style="display:none;">if (pos[i] &gt;= 0) { /* mot &quot;sol&quot; trouve dans les donn&eacute;es re&ccedil;ues */
       // indexOf donne la position du d&eacute;but du mot cl&eacute;,
       // en ajoutant sa longueur on se place &agrave; la fin.
       pos[i] += keyword.length();
       
       Serial.print(&quot;pos &quot;);  Serial.print(i);Serial.print(&quot; = &quot;);
       Serial.println(pos[i]); 
               
      // extraction de valeur &agrave; la fin de ligne
             ligne=ligne.substring(pos[i], longueur);
             Serial.print(&quot;extrait = &quot;);
             Serial.println(ligne);

          // extraction de la valeur situ&eacute;e jusqu'&agrave; la premi&egrave;re virgule 
             String valeur_sol=ligne.substring(0,ligne.indexOf(&quot;,&quot;));
          // affichage de la donn&eacute;e brute extraite
             Serial.print(&quot;temperature_sol = &quot;);
             Serial.println(valeur_sol);
     
          
          // conversion de la valeur du format texte au format flottant
             temperature[i] = atof(&amp;valeur_sol[0])-273;
             Serial.print(&quot;temperature_sol = &quot;);
             Serial.println(temperature[i]);</pre></div></div></div><div class="rBk "><p>6. <strong class="txt_emp_is ">Affichage des donn&eacute;es&nbsp;:</strong></p></div><div class="rBk listing"><div><div class="code"><div class="code-form "><div class="CodeMirror-static cm-s-default" data-lang="text/x-csharp"><div class="CodeMirror-code"><div class="CodeMirror-line"><div class="CodeMirror-linenumber">1</div><pre> <span class="cm-keyword">for</span> (<span class="cm-variable-3">int</span> <span class="cm-variable">x</span><span class="cm-operator">=</span><span class="cm-number">0</span>; <span class="cm-variable">x</span> <span class="cm-operator">&lt;</span> <span class="cm-number">15</span>; <span class="cm-variable">x</span><span class="cm-operator">++</span>){</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">2</div><pre>       <span class="cm-variable">Serial</span>.<span class="cm-variable">print</span> (<span class="cm-string">&quot;Temperature mesuree le :&quot;</span>); <span class="cm-variable">Serial</span>.<span class="cm-variable">print</span>(<span class="cm-variable">jour</span>[<span class="cm-variable">x</span>]);<span class="cm-variable">Serial</span>.<span class="cm-variable">print</span>(<span class="cm-string">&quot; &quot;</span>); <span class="cm-variable">Serial</span>.<span class="cm-variable">println</span>(<span class="cm-variable">nommois</span>[<span class="cm-variable">mois</span>[<span class="cm-variable">x</span>].<span class="cm-variable">toInt</span>()<span class="cm-operator">-</span><span class="cm-number">1</span>]); </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">3</div><pre>       </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">4</div><pre>       <span class="cm-variable">Serial</span>.<span class="cm-variable">print</span> (<span class="cm-string">&quot;heure : &quot;</span>); <span class="cm-variable">Serial</span>.<span class="cm-variable">print</span> (<span class="cm-variable">heure</span>[<span class="cm-variable">x</span>]);<span class="cm-variable">Serial</span>.<span class="cm-variable">print</span> (<span class="cm-string">&quot; h &quot;</span>);<span class="cm-variable">Serial</span>.<span class="cm-variable">print</span> (<span class="cm-string">&quot;= &quot;</span>); <span class="cm-variable">Serial</span>.<span class="cm-variable">println</span>(<span class="cm-variable">temperature</span>[<span class="cm-variable">x</span>]); </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">5</div><pre>       <span class="cm-variable">Serial</span>.<span class="cm-variable">println</span>();</pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">6</div><pre> </pre></div><div class="CodeMirror-line"><div class="CodeMirror-linenumber">7</div><pre>   } </pre></div></div></div></div><pre class="code-raw noIndex " style="display:none;"> for (int x=0; x &lt; 15; x++){
       Serial.print (&quot;Temperature mesuree le :&quot;); Serial.print(jour[x]);Serial.print(&quot; &quot;); Serial.println(nommois[mois[x].toInt()-1]); 
       
       Serial.print (&quot;heure : &quot;); Serial.print (heure[x]);Serial.print (&quot; h &quot;);Serial.print (&quot;= &quot;); Serial.println(temperature[x]); 
       Serial.println();
 
   } </pre></div></div></div></div></div><div class="method pBk"><h3 class="method_ti pBk_ti"><span><i class="type"><span>M&eacute;thode</span></i><span class="hidden"> : </span><span class="title">Validation du programme</span></span></h3><div class="method_co pBk_co"><div class="rBk "><div class="txtRes "><div class="txt "><p><strong class="txt_emp_is ">Tester le programme et v&eacute;rifier sur le site que les valeurs que vous avez extraites sont coh&eacute;rentes.</strong></p></div><div class="img rgt "><figure role="group" class="resInFlow jpeg"><div class="resInFlow_co "><img src="../res/valide.jpg" width="110" height="135" alt></div></figure></div></div></div></div></div></div></section></div></div><div id="navigation" tabindex="-1"><hr class="hidden"><nav class="pageTurner" role="navigation"><ul><li><a rel="prev" href="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API_4.html" target="_self" class="btnNav prev" title="Pr&eacute;c&eacute;dent (Droits d'utilisation des donn&eacute;es)"><span>Pr&eacute;c&eacute;dent</span></a></li><li><a rel="next" href="8_Mini-Projet.html" target="_self" class="btnNav next" title="Suivant (Mini-Projet)"><span>Suivant</span></a></li></ul></nav></div></div><div id="toolbox"><nav id="menu" class="pageSelector" role="navigation" tabindex="-1" aria-label="menu principal"><hr class="hidden"><ul class="mnu static" data-totalPages="50"><li class="sel_no anc_no type_l  dpt_0 intro"><div class="lbl type_l" id="module_IoT_format_enseignant_1.html"><a href="module_IoT_format_enseignant_1.html" target="_self" class="item"><span>Introduction</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="1_organisation_pedagogique.html"><a href="1_organisation_pedagogique.html" target="_self" class="item"><span>Organisation p&eacute;dagogique</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="2_Transmission_de_l_information_par_la_mise_en_oeuvre_d_objets_connectes.html"><a href="2_Transmission_de_l_information_par_la_mise_en_oeuvre_d_objets_connectes.html" target="_self" class="item"><span>Transmission de l'information par la mise en &oelig;uvre d'objets connect&eacute;s.</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="3_Introduction_au_monde_de_l_objet_connecte_et_presentation_de_quelques_sigles_et_acronymes_du_monde_des_objets_connectes.html"><a href="3_Introduction_au_monde_de_l_objet_connecte_et_presentation_de_quelques_sigles_et_acronymes_du_monde_des_objets_connectes.html" target="_self" class="item"><span>Introduction au monde de l'objet connect&eacute; et pr&eacute;sentation de quelques sigles et acronymes du monde des objets connect&eacute;s</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="4_Connexion_d_un_objet_au_reseau_WiFi_avec_un_EPS8266.html"><a href="4_Connexion_d_un_objet_au_reseau_WiFi_avec_un_EPS8266.html" target="_self" class="item"><span>Connexion d'un &quot;objet&quot; au r&eacute;seau WiFi avec un EPS8266</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="5_Connexion_d_un_objet_au_reseau_WiFi_avec_un_ESP32.html"><a href="5_Connexion_d_un_objet_au_reseau_WiFi_avec_un_ESP32.html" target="_self" class="item"><span>Connexion d'un &quot;objet&quot; au r&eacute;seau WiFi avec un ESP32</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="6_Activite_1__envoi_de_donnees_d_un_capteur_sur_un_serveur_web_et_affichage_dans_une_IHM.html"><a href="6_Activite_1__envoi_de_donnees_d_un_capteur_sur_un_serveur_web_et_affichage_dans_une_IHM.html" target="_self" class="item"><span>Activit&eacute; 1&nbsp;: envoi de donn&eacute;es d'un capteur sur un serveur web et affichage dans une IHM</span></a></div></li><li class="sel_no anc_yes type_b  dpt_0 courseUa"><div class="lbl type_b" id="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API.html"><a href="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API.html" target="_self" class="item" type="up"><span>Activit&eacute; 2&nbsp;: Lecture et extraction de donn&eacute;es depuis une API</span></a></div><ul class="sub mnu_open"><li class="sel_no anc_no type_l  dpt_1 intro"><div class="lbl type_l" id="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API_1.html"><a href="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API_1.html" target="_self" class="item"><span>Introduction</span></a></div></li><li class="sel_no anc_no type_l  dpt_1 expUc"><div class="lbl type_l" id="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API_2.html"><a href="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API_2.html" target="_self" class="item"><span>Donn&eacute;es propos&eacute;es par l'API</span></a></div></li><li class="sel_no anc_no type_l  dpt_1 expUc"><div class="lbl type_l" id="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API_3.html"><a href="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API_3.html" target="_self" class="item"><span>Connexion s&eacute;curis&eacute;e SSL</span></a></div></li><li class="sel_no anc_no type_l  dpt_1 expUc"><div class="lbl type_l" id="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API_4.html"><a href="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API_4.html" target="_self" class="item"><span>Droits d'utilisation des donn&eacute;es</span></a></div></li><li class="sel_yes anc_no type_l  dpt_1 expUc"><div class="lbl type_l" id="7_Activite_2_Lecture_et_extraction_de_donnees_depuis_une_API_5.html"><span class="item"><span>Parser les donn&eacute;es extraites</span></span></div></li></ul></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="8_Mini-Projet.html"><a href="8_Mini-Projet.html" target="_self" class="item"><span>Mini-Projet</span></a></div></li><li class="sel_no anc_no type_b  type_b_c dpt_0 courseUa"><div class="lbl type_b" id="9_Pour_aller_plus_loin.html"><a href="9_Pour_aller_plus_loin.html" target="_self" class="item"><span>Pour aller plus loin</span></a></div></li></ul></nav><div id="tools" tabindex="-1"><hr class="hidden"><nav class="headingSelector" role="navigation"><ul class="mnu"><li class="anc_no home" data-position="uncle"><div class="lbl"><a href="module_IoT_format_enseignant.html" target="_self" class="item" type="index" title="Page d'accueil du module"><span>Accueil</span></a></div></li><li class="anc_yes module" data-position="ancestor"><div class="lbl"><span class="item"><span>Module</span></span></div></li></ul></nav></div></div></main><footer id="footer" role="contentinfo" tabindex="-1"><hr class="hidden"><a id="linkSp" target="_blank" href="https://www.scenari.org" title="R&eacute;alis&eacute; avec Scenari (nouvelle fen&ecirc;tre)"><span><img alt="R&eacute;alis&eacute; avec Scenari (nouvelle fen&ecirc;tre)" src="../skin/img/tpl/scBtn.png"></span></a></footer></div>
  <script type="text/JavaScript" src="../skin/js/skin.js"></script>
  <script type="text/javascript">tplMgr.init();scCodeMgr.init();scMediaMgr.init("ide:content/chi:div/chi:section/des:.mediaPlayer",{processYoutubeUrlsÂ :true});scImgMgr.init();outMgr.init();</script>
 </body>
</html>
